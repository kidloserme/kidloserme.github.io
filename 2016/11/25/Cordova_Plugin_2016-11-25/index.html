<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="author" content="Holo Wang"><meta name="description" content="跟着Cordova：HelloWord搞定了怎么创建一个Android项目之后，看看怎么使用Cordova的Plugin吧。因为使用命令行创建的项目导图AS时报错，有问题，所以这里直接创建一个项目，然后将需要的文件拷贝到项目中去即可。1.添加插件首先要通过cordova命"><meta name="keywords" content="Cordova"><title>Cordova：Plugin · 加贝龙</title><link rel="icon" href="/long_02.jpg"><link rel="canonical" href="http://yoursite.com/2016/11/25/Cordova_Plugin_2016-11-25/"><link rel="alternate" href="/atom.xml" title="加贝龙"><link rel="stylesheet" href="/fonts/iconfont/iconfont.css"><link rel="stylesheet" href="/css/style.css"></head><body><div id="main"><header><a href="/." class="logo">加贝龙</a><ul class="nav"><li class="nav-link"><a href="/" target="_self">首页</a></li><li class="nav-link"><a href="/archives/" target="_self">归档</a></li><li class="nav-link"><a href="/categories/" target="_self">分类</a></li><li class="nav-link"><a href="/tags/" target="_self">标签</a></li><li class="nav-link"><a href="/about/" target="_self">关于</a></li></ul></header><section id="container"><article class="post"><h1 class="post-title">Cordova：Plugin</h1><span class="post-time">2016年11月25日</span><div id="sidebar" class="post-sidebar"><h3 class="heading">目录</h3><ol class="toc"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-1首先创建一个Library"><span class="toc-text">3.1首先创建一个Library</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2拷贝CordovaLib源文件"><span class="toc-text">3.2拷贝CordovaLib源文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-3拷贝Plugin源代码"><span class="toc-text">3.3拷贝Plugin源代码</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-4拷贝Cordova配置文件"><span class="toc-text">3.4拷贝Cordova配置文件</span></a></li></ol></div><div class="post-content"><p>跟着<a href="http://kidloserme.github.io/2016/11/22/Cordova_Helloword_2016-11-22/" target="_blank" rel="external">Cordova：HelloWord</a>搞定了怎么创建一个Android项目之后，看看怎么使用Cordova的Plugin吧。<br>因为使用命令行创建的项目导图AS时报错，有问题，所以这里直接创建一个项目，然后将需要的文件拷贝到项目中去即可。</p>
<blockquote>
<p>1.添加插件</p>
</blockquote>
<p>首先要通过cordova命令添加所需要的插件，此次测试一个比较简单的插件dialog，添加的命令<code>cordova plugin add cordova-plugin-dialogs</code>，看下图：<br><img src="../../../../images/cordova/add_plugin.png" width="70%" align="center"><br>OK，添加成功了，从上图中可以看到进入到android/assets/www/plugins目录中已经有我们刚才添加的插件了，下面开始看怎么使用他吧。</p>
<a id="more"></a>
<blockquote>
<p>2.创建新工程</p>
</blockquote>
<p>下面是心创建的一个全新的项目HelloCordova<br><img src="../../../../images/cordova/create_hello_cordova.png" width="70%" align="center"></p>
<blockquote>
<p>3.引入CordovaLib库</p>
</blockquote>
<h5 id="3-1首先创建一个Library"><a href="#3-1首先创建一个Library" class="headerlink" title="3.1首先创建一个Library"></a>3.1首先创建一个Library</h5><p><img src="../../../../images/cordova/new_lib_module.png" width="70%" align="center"></p>
<p><img src="../../../../images/cordova/cordovalib.png" width="70%" align="center"></p>
<h5 id="3-2拷贝CordovaLib源文件"><a href="#3-2拷贝CordovaLib源文件" class="headerlink" title="3.2拷贝CordovaLib源文件"></a>3.2拷贝CordovaLib源文件</h5><p>Library创建完成后将我们需要的代码拷贝进来，要拷贝的代码在此目录下：<br><img src="../../../../images/cordova/lib_src.png" width="70%" align="center"><br>直接拷贝到项目中：<br><img src="../../../../images/cordova/copySrcToLib.png" width="70%" align="center"></p>
<h5 id="3-3拷贝Plugin源代码"><a href="#3-3拷贝Plugin源代码" class="headerlink" title="3.3拷贝Plugin源代码"></a>3.3拷贝Plugin源代码</h5><p>Plugin的源代码在android/src目录下：<br><img src="../../../../images/cordova/pluginSrc.png" width="70%" align="center"><br>拷贝后：<br><img src="../../../../images/cordova/copyPluginSrcToLib.png" width="70%" align="center"><br>Device是创建项目的时候就有的，dialogs就是我们刚才添加的。</p>
<h5 id="3-4拷贝Cordova配置文件"><a href="#3-4拷贝Cordova配置文件" class="headerlink" title="3.4拷贝Cordova配置文件"></a>3.4拷贝Cordova配置文件</h5><p>下面要拷贝的是res目录下的config文件，同样是拷贝到cordovalib的res目录下：<br><img src="../../../../images/cordova/configfile.png" width="70%" align="center"></p>
<p><img src="../../../../images/cordova/copyConfigToLib.png" width="70%" align="center"><br>config.xml的内容感兴趣的可以自己搜一下，里面主要是配置一些插件信息以及项目信息</p>
<blockquote>
<p>4.拷贝H5资源</p>
</blockquote>
<p>H5资源位于android/assets目录下：<br><img src="../../../../images/cordova/H5Resource.png" width="70%" align="center"></p>
<p>H5资源拷贝到主工程同样的位置：<br><img src="../../../../images/cordova/CopyH5Resource.png" width="70%" align="center"></p>
<blockquote>
<p>5.Activity加载</p>
</blockquote>
<p>首先要在主工程的build.gradle中添加对cordovalib的依赖：<br><img src="../../../../images/cordova/addCompileLib.png" width="70%" align="center"></p>
<p>直接使用android/src下的MainActivity:<br><img src="../../../../images/cordova/main.png" width="70%" align="center"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">public class MainActivity extends CordovaActivity &#123;</div><div class="line">    @Override</div><div class="line">    public void onCreate(Bundle savedInstanceState) &#123;</div><div class="line">        super.onCreate(savedInstanceState);</div><div class="line"></div><div class="line">        // enable Cordova apps to be started in the background</div><div class="line">        Bundle extras = getIntent().getExtras();</div><div class="line">        if (extras != null &amp;&amp; extras.getBoolean(&quot;cdvStartInBackground&quot;, false)) &#123;</div><div class="line">            moveTaskToBack(true);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        Log.e(&quot;holo_cordova&quot;, &quot;launchUrl:  &quot; + launchUrl);</div><div class="line">        // Set by &lt;content src=&quot;index.html&quot; /&gt; in config.xml</div><div class="line">        loadUrl(launchUrl);</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>看注释<code>loadUrl(launchUrl);</code>中的launchUrl是在res/xml/config.xml中配置的，对应的是assets/www/index.html.<br>OK，基本搞定了80%，下面就是对index.html改造，引入我们刚才添加的Plugin dialogs.</p>
<blockquote>
<p>6.在js文件中使用dialogs Plugin</p>
</blockquote>
<p>首先我们在assets/js目录下创建一个js文件，就叫dialogsplugin.js，然后开始编码：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">onConfirm</span>(<span class="params">buttonIndex</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'confirm dialog cancel ..........'</span>);</div><div class="line">    navigator.notification.alert(<span class="string">'You selected button '</span> + buttonIndex);</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'confirm dialog cancel __________'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">onDeviceReady</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'will alert confirm dialog'</span>);</div><div class="line">    navigator.notification.confirm(</div><div class="line">        <span class="string">'You are the winner xx!'</span>, <span class="comment">// message</span></div><div class="line">         onConfirm,            <span class="comment">// callback to invoke with index of button pressed</span></div><div class="line">        <span class="string">'Game Over'</span>,           <span class="comment">// title</span></div><div class="line">        [<span class="string">'Restart'</span>,<span class="string">'Exit'</span>]     <span class="comment">// buttonLabels</span></div><div class="line">    );</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'confirm dialog alert end'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">document</span>.addEventListener(<span class="string">"deviceready"</span>, onDeviceReady, <span class="literal">false</span>);</div></pre></td></tr></table></figure></p>
<p>js编码完成，在html中引入就大功告成了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;js/dialogsplugin.js&quot;&gt;&lt;/script&gt;</div></pre></td></tr></table></figure></p>
<p>然后运行项目,看效果图：<br><img src="../../../../images/cordova/urwinner.png" width="70%" align="center"></p>
</div></article><div class="tags"><a href="/tags/Cordova/">Cordova</a></div><div class="paginator"><a href="/2016/11/25/JingoalPush_2016-11-25/" class="prev"><i class="iconfont icon-left"></i><span> 上一页</span></a><a href="/2016/11/22/Cordova_Helloword_2016-11-22/" class="next"><span>下一页</span><i class="iconfont icon-right"></i></a></div></section><footer><div class="copyright"><p class="power">Powered by <a href="https://hexo.io/">Hexo</a> and Theme by <a href="https://github.com/ahonn/hexo-theme-even"> Even</a></p><p class="since">&copy;2016<span class="heart"><i class="iconfont icon-heart"></i></span><span class="author">Holo Wang</span></p></div><label id="back2top"><i class="iconfont icon-up"></i></label></footer></div><script src="/js/zepto.min.js"></script><script src="/js/theme.js"></script></body></html>